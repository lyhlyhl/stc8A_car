C51 COMPILER V9.53.0.0   TEXT1                                                             07/22/2020 14:45:22 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE TEXT1
OBJECT MODULE PLACED IN text1.OBJ
COMPILER INVOKED BY: F:\MDK5\C51\BIN\C51.EXE text1.c LARGE OMF2 OPTIMIZE(2,SPEED) BROWSE INCDIR(..\hardware\delay;..\har
                    -dware\IIC;..\hardware\OLED;..\hardware\ADC;..\hardware\Mpu6050;..\hardware\KEY;..\hardware\LED;..\hardware\PWM;..\hardwa
                    -re\pca;..\hardware\timer;..\hardware\PID;..\hardware\CCD;..\hardware\UART) DEBUG TABS(3)

line level    source

   1          #include "common.h"
   2          #include "main.h"
   3          extern int mpu_gyro_x, mpu_gyro_y, mpu_gyro_z;
   4          extern int flag;
   5          extern struct P_pid pid_speed;
   6          extern unsigned long length;
   7          
   8          int dat1, dat2,dat_set = 1;
   9          void main(void)
  10          {
  11   1            int i = 0,flag_1 = 0;
  12   1            float speed_L, speed_R,pwm_value = 50;
  13   1            char test[20] = "abc";
  14   1            init_all();
  15   1            Pwm_set(-50, -50);
  16   1            while (1)
  17   1            {
  18   2      
  19   2                  //    if(tsl1401_finish_flag)
  20   2                  //    {
  21   2                  //       //发送图像到上位机
  22   2                  //       ccd_send_data(UART_1, ccd_data);
  23   2      
  24   2                  //       //采集完成标志位清除
  25   2                  //       tsl1401_finish_flag = 0;
  26   2                  //    }
  27   2                  
  28   2      
  29   2                  speed_L = GetCarSpeed(dat1);
  30   2                  speed_R = GetCarSpeed(dat2);
  31   2                  OLED_Show_float(0, 2, speed_L);
  32   2                  OLED_Show_float(0, 3, speed_R);
  33   2                  OLED_ShowNum(0, 4, dat_set,5);
  34   2                  OLED_Show_float(0, 5, pwm_value);
  35   2                  OLED_ShowNum(0, 0, dat1, 5);
  36   2                  OLED_ShowNum(0, 1, dat2, 5);
  37   2               
  38   2                 // sprintf(test, "%d %d\r\n", dat1, dat2);
  39   2                 // uart_putstr(test);
  40   2                  if (KEYScan(3) == 3)
  41   2                  {
  42   3                        dat_set += 1;
  43   3                        flag_1 = 0;
  44   3                  }
  45   2                  else if (KEYScan(4) == 4)
  46   2                  {
  47   3                        dat_set -= 1;
  48   3                        flag_1 = 0;
  49   3                  }
  50   2                  else if (KEYScan(2) == 2)
  51   2                  {
  52   3                        flag_1 = 1;
  53   3                  }
C51 COMPILER V9.53.0.0   TEXT1                                                             07/22/2020 14:45:22 PAGE 2   

  54   2                  if(flag_1 == 1)
  55   2                  {
  56   3                     pwm_value = PID_realize(dat_set - ((dat1 + dat2) / 2),pid_speed);
  57   3                     Pwm_set(pwm_value,pwm_value);
  58   3                  }
  59   2                  //mpu6050_get_accdata();
  60   2                  //mpu6050_get_gyro();
  61   2                  //sprintf(test,"%d %d %d",mpu_gyro_x,mpu_gyro_y,mpu_gyro_z);
  62   2                  //OLED_ShowString(0,3,test);
  63   2                  //Delay1ms(100);
  64   2                  //LED = 0;
  65   2                  //TR0 = 0;
  66   2            }
  67   1      }
  68          
  69          void init_all()
  70          {
  71   1            //    P_SW2 = 0x80;
  72   1            // XOSCCR = 0xc0;          // 启动外部晶振
  73   1            // while (!(XOSCCR & 1));  // 等待时钟稳定
  74   1            // CLKDIV = 0x00;          // 时钟不分频
  75   1            // CKSEL = 0x01;        // 选择外部晶振
  76   1            // P_SW2 = 0x00;
  77   1            OLED_Init();
  78   1            //simiic_init();
  79   1            //mpu6050_init();
  80   1            //pca_input_init();
  81   1            speed_count_init();
  82   1      
  83   1            Timer_uart_init();
  84   1            Timer0_init();
  85   1            //ccd_init();
  86   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    582    ----
   CONSTANT SIZE    =     20    ----
   XDATA SIZE       =      6      36
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
