C51 COMPILER V9.60.0.0   TEXT1                                                             07/22/2020 15:40:40 PAGE 1   


C51 COMPILER V9.60.0.0, COMPILATION OF MODULE TEXT1
OBJECT MODULE PLACED IN text1.OBJ
COMPILER INVOKED BY: D:\keil\C51\BIN\C51.EXE text1.c LARGE OMF2 OPTIMIZE(2,SPEED) BROWSE INCDIR(..\hardware\delay;..\har
                    -dware\IIC;..\hardware\OLED;..\hardware\ADC;..\hardware\Mpu6050;..\hardware\KEY;..\hardware\LED;..\hardware\PWM;..\hardwa
                    -re\pca;..\hardware\timer;..\hardware\PID;..\hardware\CCD;..\hardware\UART) DEBUG TABS(2)

line level    source

   1          #include "common.h"
   2          #include "main.h"
   3          extern int mpu_gyro_x, mpu_gyro_y, mpu_gyro_z;
   4          extern int flag;
   5          extern struct P_pid pid_speed;
   6          extern unsigned long length;
   7          
   8          int uflag=0;
   9          
  10          int dat1, dat2,dat_set = 1;
  11          void main(void)
  12          {
  13   1            int i = 0,flag_1 = 0;
  14   1            float speed_L, speed_R,pwm_value = 50;
  15   1            char test[20] = "abc";
  16   1            init_all();
  17   1            Pwm_set(-50, -50);
  18   1            while (1)
  19   1            {
  20   2              
  21   2              
  22   2              if (uflag == 1)
  23   2              {
  24   3                spilt_str();
  25   3                uflag =0;
  26   3              }
  27   2      
  28   2                  //    if(tsl1401_finish_flag)
  29   2                  //    {
  30   2                  //      //发送图像到上位机
  31   2                  //      ccd_send_data(UART_1, ccd_data);
  32   2      
  33   2                  //      //采集完成标志位清除
  34   2                  //      tsl1401_finish_flag = 0;
  35   2                  //    }
  36   2                  
  37   2      
  38   2                  speed_L = GetCarSpeed(dat1);
  39   2                  speed_R = GetCarSpeed(dat2);
  40   2                  OLED_Show_float(0, 2, speed_L);
  41   2                  OLED_Show_float(0, 3, speed_R);
  42   2                  OLED_ShowNum(0, 4, dat_set,5);
  43   2                  OLED_Show_float(0, 5, pwm_value);
  44   2                  OLED_ShowNum(0, 0, dat1, 5);
  45   2                  OLED_ShowNum(0, 1, dat2, 5);
  46   2               
  47   2                 // sprintf(test, "%d %d\r\n", dat1, dat2);
  48   2                 // uart_putstr(test);
  49   2                  if (KEYScan(3) == 3)
  50   2                  {
  51   3                        dat_set += 1;
  52   3                        flag_1 = 0;
  53   3                  }
C51 COMPILER V9.60.0.0   TEXT1                                                             07/22/2020 15:40:40 PAGE 2   

  54   2                  else if (KEYScan(4) == 4)
  55   2                  {
  56   3                        dat_set -= 1;
  57   3                        flag_1 = 0;
  58   3                  }
  59   2                  else if (KEYScan(2) == 2)
  60   2                  {
  61   3                        flag_1 = 1;
  62   3                  }
  63   2                  if(flag_1 == 1)
  64   2                  {
  65   3                     pwm_value = PID_realize(dat_set - ((dat1 + dat2) / 2),pid_speed);
  66   3                     Pwm_set(pwm_value,pwm_value);
  67   3                  }
  68   2                  //mpu6050_get_accdata();
  69   2                  //mpu6050_get_gyro();
  70   2                  //sprintf(test,"%d %d %d",mpu_gyro_x,mpu_gyro_y,mpu_gyro_z);
  71   2                  //OLED_ShowString(0,3,test);
  72   2                  //Delay1ms(100);
  73   2                  //LED = 0;
  74   2                  //TR0 = 0;
  75   2            }
  76   1      }
  77          
  78          void init_all()
  79          {
  80   1            //    P_SW2 = 0x80;
  81   1            //  XOSCCR = 0xc0;      // 启动外部晶振
  82   1            //  while (!(XOSCCR & 1));  // 等待时钟稳定
  83   1            //  CLKDIV = 0x00;      // 时钟不分频
  84   1            //  CKSEL = 0x01;       // 选择外部晶振
  85   1            //  P_SW2 = 0x00;
  86   1            OLED_Init();
  87   1            //simiic_init();
  88   1            //mpu6050_init();
  89   1            //pca_input_init();
  90   1            speed_count_init();
  91   1      
  92   1            Timer_uart_init();
  93   1            Timer0_init();
  94   1            //ccd_init();
  95   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    619    ----
   CONSTANT SIZE    =     20    ----
   XDATA SIZE       =      8      36
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
