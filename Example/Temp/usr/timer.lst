C51 COMPILER V9.53.0.0   TIMER                                                             07/16/2020 15:50:31 PAGE 1   


C51 COMPILER V9.53.0.0, COMPILATION OF MODULE TIMER
OBJECT MODULE PLACED IN .\timer.obj
COMPILER INVOKED BY: F:\MDK5\C51\BIN\C51.EXE ..\hardware\timer\timer.c LARGE OMF2 OPTIMIZE(2,SPEED) BROWSE INCDIR(..\har
                    -dware\delay;..\hardware\IIC;..\hardware\OLED;..\hardware\ADC;..\hardware\Mpu6050;..\hardware\KEY;..\hardware\LED;..\hard
                    -ware\PWM;..\hardware\pca;..\hardware\timer;..\hardware\PID) DEBUG PRINT(.\timer.lst) TABS(3) OBJECT(.\timer.obj)

line level    source

   1          #include "timer.h"
   2          #include "LED.h"
   3          
   4          int flag = 0;
   5          void Timer_uart_init() //串口中断初始化
   6          {
   7   1         SCON |= 0x50;                          //REN=1允许串行接受状态，串口工作模式2
   8   1         TMOD |= 0x00;                          //定时器1为模式0（16位自动重载）
   9   1         AUXR = 0X40;                           //开启1T模式`    PS：这一行不能或等于不然串口无法打开
  10   1         TL1 = (65535 - (24000000 / 4 / 9600)); //设置波特率重装值
  11   1         TH1 = (65535 - (24000000 / 4 / 9600)) >> 8;
  12   1         TR1 = 1; //开启定时器1
  13   1         ES = 1;  //开串口中断
  14   1         EA = 1;  // 开总中断
  15   1      }
  16          
  17          void Timer0_init() //定时器中断0初始化
  18          {
  19   1         TMOD |= 0x00;
  20   1         //AUXR|=0x80; //开启1T模式
  21   1         TL0 = 0x30; //定时器1ms
  22   1         TH0 = 0xf8;
  23   1         TR0 = 1;
  24   1         ET0 = 1;
  25   1         EA = 1;
  26   1      }
  27          
  28          void speed_count_init()
  29          {
  30   1         T3L = 0x55;
  31   1         T3H = 0x55;
  32   1      
  33   1         T4L = 0x55;
  34   1         T4H = 0x55;
  35   1      
  36   1         IE2 = 0x60;
  37   1         T4T3M = 0xcc;
  38   1      
  39   1         EA = 1;
  40   1      }
  41          
  42          void time0_itp() interrupt 1
  43          {
  44   1         static int cnt = 0;
  45   1         if (cnt >= 50)
  46   1         {
  47   2            flag = 1;
  48   2            cnt = 0;
  49   2         }
  50   1         cnt++;
  51   1      }
  52          void TM3() interrupt 19
  53          {
C51 COMPILER V9.53.0.0   TIMER                                                             07/16/2020 15:50:31 PAGE 2   

  54   1         //LED = !LED;
  55   1         AUXINTIF &= ~T3IF;
  56   1      }
  57          
  58          void TM4() interrupt 20
  59          {
  60   1         //LED = !LED;
  61   1         AUXINTIF &= ~T4IF;
  62   1      }


MODULE INFORMATION:   STATIC OVERLAYABLE
   CODE SIZE        =    154    ----
   CONSTANT SIZE    =   ----    ----
   XDATA SIZE       =      4    ----
   PDATA SIZE       =   ----    ----
   DATA SIZE        =   ----    ----
   IDATA SIZE       =   ----    ----
   BIT SIZE         =   ----    ----
   EDATA SIZE       =   ----    ----
   HDATA SIZE       =   ----    ----
   XDATA CONST SIZE =   ----    ----
   FAR CONST SIZE   =   ----    ----
END OF MODULE INFORMATION.


C51 COMPILATION COMPLETE.  0 WARNING(S),  0 ERROR(S)
